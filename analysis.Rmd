---
title: "analysis"
author: "J Ted Hillert (Carter)"
date: "`r Sys.Date()`"
output:
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(message=FALSE,
                      echo=FALSE,
                      warning=FALSE)

library(broom)
library(car)       # Primarily for the Anova() function
library(DescTools) # For the GTest
library(emmeans)
library(FactoMineR)  # provides exploratory mutlivariate methods
library(factoextra)  # Visualize the Results of Multivariate Data Analyses
library(ggfortify)
library(ggplot2)
library(ggpubr)
library(ggrepel)
library(kableExtra)
library(lattice)   # For diagnostic plots of linear models in LME4
library(latex2exp)
library(lme4)      # For linear mixed effects modelling
library(lmerTest)  # To provide P-values for lme4
library(patchwork)
library(purrr)
library(readxl)
library(tidyverse)
library(stats)
library(vegan)


papaja::r_refs(file = "schmesis.bib")

options(knitr.kable.NA = "")

set.seed(42)


```

# Import

```{r imports, message=FALSE, warning=FALSE, include=FALSE}

# R/Excel data \/\/
vege<-read_excel("round bald datas/round bald data.xlsx",
                 sheet = "Ground Cover")



view(vege)


# PC-ORD data \/\/

nms<-read_excel("round bald datas/2020-2022 ordination.xlsx",sheet = "NMS")

```

# NMS
```{r NMS}

ggplot(nms) +
  geom_jitter(aes(x=Axis1, 
                  y=Axis2, 
                  color=Fire,
                  ),
              width=0.3, 
              alpha=0.5, 
              size=4, 
              shape=16)+
  xlab("")+
  theme_classic()



```

# homogeneous

```{r hom, include=FALSE}

#rubus
barrub<-bartlett.test(Rubus~Fire,
              data=vege)

levrub<-leveneTest(Rubus~Fire,
            center=median,
            data=vege)

flirub<-fligner.test(Rubus~Fire,
             data=vege)

barrub   #0.7099
levrub   #0.5862
flirub   #0.485


#grass
bargra<-bartlett.test(Grass~Fire,
              data=vege)

levgra<-leveneTest(Grass~Fire,
            center=median,
            data=vege)

fligra<-fligner.test(Grass~Fire,
             data=vege)


bargra #0.09208
levgra #0.04229
fligra #0.04673


#sedge
barsed<-bartlett.test(Sedge~Fire,
              data=vege)

levsed<-leveneTest(Sedge~Fire,
            center=median,
            data=vege)

flised<-fligner.test(Sedge~Fire,
             data=vege)

barsed #0.0006044
levsed #0.01768
flised #6.853e-5



```


# lm.modA

```{r vegemod, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}

rubu<-lm(Rubus~Fire,
         data=vege)
aovrubu<-aov(rubu)
ottorubu<-autoplot(aovrubu)
ottorubu

gras<-lm(Grass~Fire,
         data=vege)
aovgras<-aov(gras)
ottogras<-autoplot(aovgras)
ottogras

sedg<-lm(Sedge~Fire,
         data=vege)
aovsedg<-aov(sedg)
ottosedg<-autoplot(aovsedg)
ottosedg



aovrubu
aovgras
aovsedg

```

# tablA_Anova.gras

```{r grazcova, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}


## Grass
#using R-car package
grasmod.out<-Anova(gras)

grasmod.out$'Pr(>F)'<-format.pval(grasmod.out$'Pr(>F)',
                                   eps=0.0001,
                                   digits=4,
                                   na.form=""
)
#grasmod.out

grasmod1.cap<-"ANOVA summary for the effect of Fire on Grass species"

#using R-kableExtra package
gramod1tab<-kbl(grasmod.out,
    align='r',
    digits=c(2,0,2,4),
    caption=grasmod1.cap
    )|>
  kable_classic(full=FALSE)


## Rubus
#using R-car package
rubumod.out<-Anova(rubu)

rubumod.out$'Pr(>F)'<-format.pval(rubumod.out$'Pr(>F)',
                                   eps=0.0001,
                                   digits=4,
                                   na.form=""
)
#rubumod.out

rubumod1.cap<-"ANOVA summary for the effect of Fire on Rubus species"

#using R-kableExtra package
rubmod1tab<-kbl(rubumod.out,
    align='r',
    digits=c(2,0,2,4),
    caption=rubumod1.cap
    )|>
  kable_classic(full=FALSE)


##Sedge
#using R-car package
sedgmod.out<-Anova(sedg)

sedgmod.out$'Pr(>F)'<-format.pval(sedgmod.out$'Pr(>F)',
                                   eps=0.0001,
                                   digits=4,
                                   na.form=""
)
#sedgmod.out

sedgmod1.cap<-"ANOVA summary for the effect of Fire on Sedge species"

#using R-kableExtra package
sedmod1tab<-kbl(sedgmod.out,
    align='r',
    digits=c(2,0,2,4),
    caption=sedgmod1.cap
    )|>
  kable_classic(full=FALSE)


gramod1tab
rubmod1tab
sedmod1tab


```

# lm.modB

```{r lmmodB, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}


## Rubus
#using @R-base package
rubmod<-lm(Rubus~Fire+Transect+Plot,
            data=vege
            )
#summary(rubmod)

#using @R-ggfortify package
rubmod<-autoplot(rubmod)



## Grass
#using @R-base package
gramod<-lm(Grass~Fire+Transect+Plot,
            data=vege
            )
#summary(gramod)

#using @R-ggfortify package
gramod<-autoplot(gramod)



## Sedge
#using @R-base package
sedmod<-lm(Sedge~Fire+Transect+Plot,
            data=vege
            )
#summary(sedmod)

#using @R-ggfortify package
sedmod<-autoplot(sedmod)


rubmod
gramod
sedmod

```

# plotB_Anovaz

```{r plotzcova, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}


# Rubus
#using R-car package
rubmod.out<-glm(rubu)

rubmod.out$'Pr(>F)'<-format.pval(rubmod.out$'Pr(>F)',
                                   eps=0.0001,
                                   digits=4,
                                   na.form=""
)
#rubmod.out

rubmod1.cap<-"ANOVA summary for the effect of Fire on Grass species"

rubus<-ggplot(vege) +
  geom_boxplot(aes(Rubus,
                   Fire))+
  geom_jitter(aes(x=Rubus, 
                  y=Fire, 
                  color=Transect
                  ),
              width=0.3, 
              alpha=0.5, 
              size=4, 
              shape=16)+
  xlab("")+
  theme_classic()


# Grass
#using R-car package
gramod.out<-glm(gras)

gramod.out$'Pr(>F)'<-format.pval(gramod.out$'Pr(>F)',
                                   eps=0.0001,
                                   digits=4,
                                   na.form=""
)
#gramod.out

gramod1.cap<-"ANOVA summary for the effect of Fire on Grass species"

grass<-ggplot(vege) +
  geom_boxplot(aes(Grass,
                   Fire))+
  geom_jitter(aes(x=Grass, 
                  y=Fire, 
                  color=Transect
                  ),
              width=0.3, 
              alpha=0.5, 
              size=4, 
              shape=16)+
  xlab("")+
  theme_classic()


# Sedge
#using R-car package
sedmod.out<-glm(sedg)

sedmod.out$'Pr(>F)'<-format.pval(sedmod.out$'Pr(>F)',
                                   eps=0.0001,
                                   digits=4,
                                   na.form=""
)
#sedmod.out

sedmod1.cap<-"ANOVA summary for the effect of Fire on Grass species"

sedge<-ggplot(vege) +
  geom_boxplot(aes(Sedge,
                   Fire))+
  geom_jitter(aes(x=Sedge, 
                  y=Fire, 
                  color=Transect
                  ),
              width=0.3, 
              alpha=0.5, 
              size=4, 
              shape=16)+
  xlab("")+
  theme_classic()


rubus
grass
sedge

```

